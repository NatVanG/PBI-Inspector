{
  "pbiEntries": [
    {
      "name": "reportLayout",
      "pbixEntryPath": "Report/Layout",
      "pbipEntryPath": "report.json",
      "contentType": "json",
      "codepage": 1200,
      "rules": [
        {
          "name": "Charts wider than tall",
          "description": "Want to check that your charts are wider than tall?",
          "disabled": false,
          "logType": "warning",
          "forEachPath": "$.sections[*]",
          "forEachPathName": "$.name",
          "forEachPathDisplayName": "$.displayName",
          "path": "$.visualContainers[*].config",
          "pathErrorWhenNoMatch": false,
          "test": [
            {
              "map": [
                {
                  "filter": [
                    {
                      "var": "visualsConfigArray"
                    },
                    {
                      "<": [
                        {
                          "var": "layouts.0.position.width"
                        },
                        {
                          "var": "layouts.0.position.height"
                        }
                      ]
                    }
                  ]
                },
                {
                  "var": "name"
                }
              ]
            },
            {
              "visualsConfigArray": "."
            },
            []
          ]
        },
        {
          "name": "Sample - ReportSlowDatasourceSettings",
          "disabled": false,
          "logType": "warning",
          "description": "Check that report slow data source settings are all disabled.",
          "path": "$.config",
          "pathErrorWhenNoMatch": true,
          "test": [
            {
              "!": [
                {
                  "or": [
                    {
                      "var": "isCrossHighlightingDisabled"
                    },
                    {
                      "var": "isSlicerSelectionsButtonEnabled"
                    },
                    {
                      "var": "isFilterSelectionsButtonEnabled"
                    },
                    {
                      "var": "isFieldWellButtonEnabled"
                    },
                    {
                      "var": "isApplyAllButtonEnabled"
                    }
                  ]
                }
              ]
            },
            {
              "isCrossHighlightingDisabled": "/slowDataSourceSettings/isCrossHighlightingDisabled",
              "isSlicerSelectionsButtonEnabled": "/slowDataSourceSettings/isSlicerSelectionsButtonEnabled",
              "isFilterSelectionsButtonEnabled": "/slowDataSourceSettings/isFilterSelectionsButtonEnabled",
              "isFieldWellButtonEnabled": "/slowDataSourceSettings/isFieldWellButtonEnabled",
              "isApplyAllButtonEnabled": "/slowDataSourceSettings/isApplyAllButtonEnabled"
            },
            true
          ]
        },
        {
          "name": "Show visual axes title",
          "description": "Check that certain charts have both axes title showing.",
          "disabled": false,
          "logType": "warning",
          "forEachPath": "$.sections[*]",
          "forEachPathName": "$.name",
          "forEachPathDisplayName": "$.displayName",
          "path": "$.visualContainers[*].config",
          "pathErrorWhenNoMatch": false,
          "test": [
            {
              "map": [
                {
                  "filter": [
                    {
                      "var": "visualsConfigArray"
                    },
                    {
                      "and": [
                        {
                          "in": [
                            {
                              "var": "singleVisual.visualType"
                            },
                            [
                              "lineChart",
                              "barChart",
                              "columnChart",
                              "clusteredBarChart",
                              "stackedBarChart"
                            ]
                          ]
                        },
                        {
                          "or": [
                            {
                              "==": [
                                {
                                  "var": "singleVisual.objects.categoryAxis.0.properties.showAxisTitle.expr.Literal.Value"
                                },
                                "false"
                              ]
                            },
                            {
                              "==": [
                                {
                                  "var": "singleVisual.objects.valueAxis.0.properties.showAxisTitle.expr.Literal.Value"
                                },
                                "false"
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "var": "name"
                }
              ]
            },
            {
              "visualsConfigArray": "."
            },
            []
          ]
        },
        {
          "name": "Percentage of charts across the report using custom colours is not greater than 10%",
          "description": "Check that charts avoid custom colours and use theme colours instead.",
          "disabled": false,
          "logType": "warning",
          "path": "$.sections[*].visualContainers[*].config",
          "pathErrorWhenNoMatch": true,
          "test": [
            {
              "<=": [
                {
                  "/": [
                    {
                      "count": [
                        {
                          "filter": [
                            {
                              "var": "visualConfigArray"
                            },
                            {
                              "and": [
                                {
                                  "!": [
                                    {
                                      "in": [
                                        {
                                          "var": "singleVisual.visualType"
                                        },
                                        [
                                          "textbox"
                                        ]
                                      ]
                                    }
                                  ]
                                },
                                {
                                  "strcontains": [
                                    {
                                      "tostring": [
                                        {
                                          "var": ""
                                        }
                                      ]
                                    },
                                    "#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})"
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "count": [
                        {
                          "filter": [
                            {
                              "var": "visualConfigArray"
                            },
                            {
                              "!": [
                                {
                                  "in": [
                                    {
                                      "var": "singleVisual.visualType"
                                    },
                                    [
                                      "textbox"
                                    ]
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                { "var": "paramMaxAllowedRatio" }
              ]
            },
            {
              "visualConfigArray": ".",
              "paramMaxAllowedRatio": 0.1
            },
            true
          ]
        },
        {
          "name": "Ensure alternativeText has been defined for all visuals",
          "description": "Alt-text is required for screen readers",
          "disabled": true,
          "logType": "warning",
          "forEachPath": "$.sections[*]",
          "forEachPathName": "$.name",
          "forEachPathDisplayName": "$.displayName",
          "path": "$.visualContainers[*].config",
          "pathErrorWhenNoMatch": false,
          "test": [
            {
              "map": [
                {
                  "filter": [
                    {
                      "var": "visualsConfigArray"
                    },
                    {
                      "none": [
                        {
                          "var": "singleVisual.vcObjects.general"
                        },
                        {
                          "or": [
                            {
                              "!!": [ { "var": "properties.altText.expr.Aggregation" } ]
                            },
                            {
                              "!=": [
                                { "var": "properties.altText.expr.Literal.Value" },
                                "''"
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "var": "name"
                }
              ]
            },
            {
              "visualsConfigArray": "."
            },
            []
          ]
        },
        {
          "name": "Disable drop shadows on visuals",
          "description": "Drop shadows are not suitable for everyone, this rule returns an array of visuals with drop shadows enabled.",
          "disabled": false,
          "logType": "warning",
          "forEachPath": "$.sections[*]",
          "forEachPathName": "$.name",
          "forEachPathDisplayName": "$.displayName",
          "path": "$.visualContainers[*].config",
          "pathErrorWhenNoMatch": false,
          "test": [
            {
              "map": [
                {
                  "filter": [
                    {
                      "var": "visualsConfigArray"
                    },
                    {
                      "some": [
                        {
                          "var": "singleVisual.vcObjects.dropShadow"
                        },
                        {
                          "==": [
                            { "var": "properties.show.expr.Literal.Value" },
                            "true"
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "var": "name"
                }
              ]
            },
            {
              "visualsConfigArray": "."
            },
            []
          ]
        },
        {
          "name": "Give visible pages meaningful names",
          "description": "Checks for visible pages with a default 'Page x' display name.",
          "disabled": false,
          "logType": "warning",
          "path": "$.sections[*]",
          "pathErrorWhenNoMatch": false,
          "test": [
            {
              "map": [
                {
                  "filter": [
                    {
                      "var": "pageArray"
                    },
                    {
                      "and": [
                        {
                          "strcontains": [
                            {
                              "var": "displayName"
                            },
                            "^Page [1-9]+$"
                          ]
                        },
                        {
                          "!=": [
                            {
                              "drillvar": "config>visibility"
                            },
                            1
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "var": "displayName"
                }
              ]
            },
            {
              "pageArray": "."
            },
            []
          ]
        },
        {
          "name": "Check Deneb charts properties - In progress",
          "description": "Check that drillvar operator can read deneb properties",
          "disabled": true,
          "logType": "error",
          "path": "$.sections[*]",
          "pathErrorWhenNoMatch": true,
          "test": [
            {
              "map": [
                {
                  "filter": [
                    {
                      "var": "pageArray"
                    },
                    {
                      "==": [
                        {
                          "drillvar": "visualContainers.0.config>singleVisual.objects.vega.0.properties.jsonSpec.expr.Literal.Value>data.name"
                        },
                        "dataset"
                      ]
                    }
                  ]
                },
                {
                  "var": "displayName"
                }
              ]
            },
            {
              "pageArray": "."
            },
            []
          ]
        },
        {
          "name": "Check for visuals overlap with a 5px margin",
          "description": "Returns names of visuals that overlap.",
          "forEachPath": "$.sections[*]",
          "forEachPathName": "$.name",
          "forEachPathDisplayName": "$.displayName",
          "path": "$.visualContainers[*].config",
          "pathErrorWhenNoMatch": false,
          "test": [
            {
              "rectoverlap": [
                {
                  "map": [
                    {
                      "filter": [
                        {
                          "var": "v"
                        },
                        {
                          "and": [
                            { "!!": [ { "var": "name" } ] },
                            {
                              "!": [
                                {
                                  "in": [
                                    {
                                      "var": "singleVisual.visualType"
                                    },
                                    [
                                      "card",
                                      "slicer",
                                      "actionButton"
                                    ]
                                  ]
                                }
                              ]
                            },
                            {
                              ">=": [
                                { "var": "layouts.0.position.x" },
                                0
                              ]
                            },
                            {
                              ">=": [
                                { "var": "layouts.0.position.y" },
                                0
                              ]
                            },
                            {
                              ">=": [
                                { "var": "layouts.0.position.width" },
                                0
                              ]
                            },
                            {
                              ">=": [
                                { "var": "layouts.0.position.height" },
                                0
                              ]
                            },
                            {
                              "!=": [
                                {
                                  "var": "singleVisual.display.mode"
                                },
                                "hidden"
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "torecord": [
                        "name",
                        {
                          "var": "name"
                        },
                        "x",
                        {
                          "var": "layouts.0.position.x"
                        },
                        "y",
                        {
                          "var": "layouts.0.position.y"
                        },
                        "width",
                        {
                          "var": "layouts.0.position.width"
                        },
                        "height",
                        {
                          "var": "layouts.0.position.height"
                        }
                      ]
                    }
                  ]
                },
                5
              ]
            },
            {
              "v": "."
            },
            []
          ]
        }
      ]
    }
  ]
}
